name: Docs Checks

permissions:
  contents: read

on:
  pull_request:
    branches: [docs]
  push:
    branches: [docs]

jobs:
  docs-checks:
    name: Docs Checks
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Validate docs structure and merge-state cleanliness
        run: |
          set -euo pipefail

          required_files=(
            AGENTS.md
            docs/PROJECT_BRIEF.md
            docs/CURRENT_STATE.md
            docs/NEXT_STEPS.md
            docs/ARCHITECTURE.md
            docs/DECISIONS.md
            docs/ROADMAP.md
            docs/RELEASE_CHECKLIST.md
            docs/VERSIONING.md
          )

          for file in "${required_files[@]}"; do
            if [ ! -f "$file" ]; then
              echo "::error::Missing required docs file: $file"
              exit 1
            fi
          done

          if rg -n "^(<<<<<<<|=======|>>>>>>>)" docs AGENTS.md README.md; then
            echo "::error::Found unresolved merge markers in docs scope."
            exit 1
          fi

          echo "Docs checks passed."
